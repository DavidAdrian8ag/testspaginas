<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <title>¿Sabes de mi?</title>

   <!-- Icono -->
   <link rel="icon" href="safe.ico" type="image/x-icon">

   <!-- Google Fonts -->
   <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;400;500;600;700&display=swap"
      rel="stylesheet">

   <!-- CSS -->
   <!-- <link rel="stylesheet" href="safe.css"> -->

   <script src="https://public.codepenassets.com/js/prefixfree-1.0.7.min.js"></script>
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <style>
      :root {
         --scroll: 0;
      }

      body {
         margin: 0;
         display: flex;
         flex-direction: column;
         overflow-x: hidden;
         background-color: #444;
      }

      main {
         height: 100vh;
      }

      .r {
         min-height: 10000px;
      }

      .safe {
         top: 0;
         bottom: 0;
         width: 100vw;
         height: 100vh;
         display: flex;
         flex-direction: column;
         align-items: center;
         justify-content: center;
         background-color: #444;
         z-index: 2;
      }

      .safe h1,
      .safe p {
         font-family: "Rajdhani", sans-serif;
         color: white;
      }

      .safe p {
         font-size: 0.9em;
         line-height: 1.5em;
         max-width: 250px;
         text-align: justify;
      }

      .box {
         width: 250px;
         height: 250px;
         display: flex;
         align-items: center;
         justify-content: center;
         transform: rotate(calc(var(--scroll) * 0.08deg));
         transform-origin: center;
      }

      .innerdial {
         position: absolute;
         top: 0;
         left: 0;
         width: 250px;
         height: 250px;
         z-index: 2;
         background-color: silver;
         border: 1px solid black;
         border-radius: 50%;
      }

      .mark {
         position: absolute;
         top: 122px;
         left: 115px;
         width: 20px;
         height: 6px;
         background-color: grey;
         border: 1px solid black;
         transform-origin: 10px 3px;
      }

      .center {
         position: absolute;
         top: 50px;
         left: 50px;
         width: 150px;
         height: 150px;
         border-radius: 50%;
         background-color: grey;
         border: 1px solid black;
      }

      .start {
         position: absolute;
         top: 70px;
         left: 65px;
         width: 20px;
         height: 10px;
         background-color: white;
         transform: rotate(-90deg) translateX(60px);
      }

      .position {
         position: relative;
         margin-top: 5px;
         text-align: center;
         padding: 5px;
         min-width: 50px;
         border: 1px solid black;
         background-color: #fff;
         font-family: "Rajdhani", sans-serif;
         color: #444;
         border-radius: 5px;
         transition: 0.3s;
         font-size: 16px !important;
      }

      .correct {
         background-color: #c6ffbf;
         color: #145214 !important;
         border-color: #2b8a3e;
         font-weight: bold;
      }

      .box-flash {
         position: absolute;
         top: 0;
         left: 0;
         width: 250px;
         height: 250px;
         background-color: silver;
         border-radius: 50%;
         opacity: 0.9;
         z-index: -1;
      }

      .click {
         animation: click 0.2s 1;
      }

      .near {
         animation: near 0.2s 1;
      }

      .off {
         animation: off 0.2s 1;
      }

      @keyframes click {
         0% {
            background-color: pink;
            transform: scale(1);
            opacity: 1;
         }

         100% {
            background-color: pink;
            transform: scale(1.5);
            opacity: 0;
         }
      }

      @keyframes near {
         0% {
            background-color: lightcoral;
            transform: scale(1);
            opacity: 0.6;
         }

         100% {
            background-color: lightcoral;
            transform: scale(1.3);
            opacity: 0;
         }
      }

      @keyframes off {
         0% {
            opacity: 0.3;
         }

         100% {
            opacity: 0;
         }
      }

      .chalkboard {
         position: absolute;
         left: 15vw;
         top: 50vh;
         padding: 20px;
         font-size: 4em;
         font-family: "Rajdhani", sans-serif;
         transform: rotate(15deg);
         color: #fff;
         white-space: pre;
         line-height: 1em;
      }

      .hint {
         position: absolute;
         right: 20px;
         bottom: 20px;
         padding: 20px;
         font-family: "Rajdhani", sans-serif;
         transform: rotate(-15deg);
         white-space: pre;
         line-height: 1em;
         color: #393939;
      }

      body.dial .safe {
         position: fixed;
      }

      body.handle main {
         overflow: hidden;
      }

      body.handle .safe {
         position: initial;
      }

      /* =======================
   PANTALLA FINAL
======================= */

      .celebration {
         display: none;
         position: fixed;
         top: 0;
         left: 0;
         width: 100vw;
         height: 100vh;
         background: radial-gradient(circle, #0a0a0a, #000);
         overflow: hidden;
         justify-content: center;
         align-items: center;
         flex-direction: column;
         z-index: 999;
      }

      .celebration::before {
         content: "";
         position: absolute;
         top: 0;
         left: 0;
         width: 100%;
         height: 100%;
         background: url("https://i.imgur.com/6g7S7uS.png");
         opacity: 0.15;
         animation: fogMove 12s ease-in-out infinite alternate;
      }

      @keyframes fogMove {
         from {
            transform: translateX(-10%) translateY(-5%);
         }

         to {
            transform: translateX(10%) translateY(5%);
         }
      }

      /* CÍRCULO MÍSTICO */
      .secret-circle {
         position: absolute;
         width: 450px;
         height: 450px;
         border-radius: 50%;
         background: radial-gradient(circle, rgba(0, 255, 200, 0.05), rgba(0, 0, 0, 0.2) 60%, transparent 90%);
         box-shadow:
            0 0 40px rgba(0, 255, 180, 0.25),
            0 0 80px rgba(0, 255, 180, 0.15),
            inset 0 0 60px rgba(0, 255, 180, 0.08);
         opacity: 0.7;
         animation: pulseCircle 6s ease-in-out infinite;
         backdrop-filter: blur(2px);
      }

      @keyframes pulseCircle {
         0% {
            transform: scale(1);
            opacity: .65;
         }

         50% {
            transform: scale(1.15);
            opacity: .9;
         }

         100% {
            transform: scale(1);
            opacity: .65;
         }
      }

      .celebration h1 {
         font-family: "Rajdhani", sans-serif;
         font-size: 3.5em;
         text-align: center;
         color: #c8ffd4;
         text-shadow: 0 0 15px #0aff9d, 0 0 25px #00d17a;
         animation: glowMystery 3s ease-in-out infinite alternate;
      }

      @keyframes glowMystery {
         from {
            opacity: .7;
            text-shadow: 0 0 10px #00d17a;
         }

         to {
            opacity: 1;
            text-shadow: 0 0 25px #0aff9d;
         }
      }

      .rune {
         position: absolute;
         font-family: "Rajdhani", sans-serif;
         font-size: 3em;
         color: #00ffbb;
         opacity: 0.07;
         animation: floatRune 6s ease-in-out infinite;
      }

      @keyframes floatRune {
         0% {
            transform: translateY(0) scale(1);
            opacity: .05;
         }

         50% {
            transform: translateY(-20px) scale(1.1);
            opacity: .12;
         }

         100% {
            transform: translateY(0) scale(1);
            opacity: .05;
         }
      }

      .rainbow-button {
         font-family: "Rajdhani", sans-serif;
         font-size: 1.6em;
         padding: 15px 40px;
         border: 1px solid #00ffbb;
         border-radius: 8px;
         background: rgba(0, 0, 0, 0.6);
         color: #00ffbb;
         cursor: pointer;
         margin-top: 40px;
         transition: 0.3s ease;
         backdrop-filter: blur(3px);
      }

      .rainbow-button:hover {
         transform: scale(1.1);
         box-shadow: 0 0 20px #00ffbb;
      }

      /* ========================================================
   AJUSTES DE RESPONSIVIDAD (PC, TABLETS, IPHONES)
   ======================================================== */

      /* Mobile First: Ajustes base para Teléfonos/iPhones (hasta 767px) */

      .safe {
         /* Reducir el padding en móviles para dar espacio al contenido */
         padding: 10px;
      }

      .box {
         /* Reducir el tamaño de la caja fuerte en móviles para que quepa */
         width: 200px;
         height: 200px;
      }

      .innerdial {
         width: 200px;
         height: 200px;
      }

      .mark {
         /* Ajustar la posición de las marcas para el nuevo tamaño del innerdial */
         top: 97px;
         /* 200px / 2 - 3px (half mark height) */
         left: 90px;
         /* 200px / 2 - 10px (half mark width) */
         transform: rotate(calc(var(--i) * 22.5deg)) translateX(80px);
         /* 100px a 80px */
      }

      /* Nota: Tu JS usa 'translateX(100px)' para el 'mark'. 
   Para que el dial quede centrado en 200px, 
   el JS debería usar 'translateX(80px)' y top/left a 97px/90px.
   Como no puedo cambiar el JS, el dial puede verse ligeramente descentrado. 
   Para corregir esto SIN tocar el JS: */

      .innerdial .mark {
         /* Anular la posición fija en móviles y centrar con flex */
         position: static;
      }

      .center {
         /* Ajustar el tamaño del centro */
         width: 100px;
         height: 100px;
         top: 50px;
         left: 50px;
      }

      .chalkboard {
         /* Mover la pizarra para que no bloquee el dial en móviles */
         left: 50%;
         top: 10vh;
         transform: translateX(-50%) rotate(0deg);
         font-size: 2em;
         text-align: center;
         position: absolute;
         width: 100%;
      }

      .hint {
         /* Mover la pista a una posición más visible en móviles */
         right: auto;
         left: 50%;
         bottom: 10px;
         transform: translateX(-50%) rotate(0deg);
         text-align: center;
         font-size: 0.8em;
         width: 90%;
      }

      .safe p {
         /* Reducir el tamaño de fuente y ancho en móviles */
         font-size: 0.8em;
         max-width: 90%;
         text-align: center;
         margin-top: 10px;
      }

      /* ====================================
   TABLETS (a partir de 768px de ancho)
   ==================================== */
      @media (min-width: 768px) {
         .box {
            width: 220px;
            height: 220px;
         }

         .innerdial {
            width: 220px;
            height: 220px;
         }

         .center {
            width: 120px;
            height: 120px;
            top: 50px;
            left: 50px;
         }

         /* Posición de elementos laterales */
         .chalkboard {
            left: 10vw;
            top: 50vh;
            transform: rotate(15deg);
            font-size: 3em;
            text-align: left;
            width: auto;
         }

         .hint {
            right: 10vw;
            bottom: 20px;
            left: auto;
            transform: rotate(-15deg);
            text-align: left;
            width: auto;
         }

         .safe p {
            max-width: 300px;
            font-size: 0.9em;
         }
      }


      /* ======================================
   PC (a partir de 1024px de ancho)
   ====================================== */
      @media (min-width: 1024px) {

         /* Restaurar los valores originales (o adaptarlos ligeramente) */
         .box {
            width: 250px;
            height: 250px;
         }

         .innerdial {
            width: 250px;
            height: 250px;
         }

         .center {
            width: 150px;
            height: 150px;
            top: 50px;
            left: 50px;
         }

         .chalkboard {
            left: 15vw;
            font-size: 4em;
         }

         .hint {
            right: 20px;
            font-size: 1em;
         }
      }
   </style>
</head>

<body class="dial">
   <main>
      <div class="r">
         <div class="safe">
            <h1>Resuelve el código</h1>

            <div class="box">
               <div class="innerdial"></div>
               <div class="box-flash"></div>
            </div>

            <input class="position" id="posInput" type="number" value="0">

            <p>Gira para encontrar la combinación. Usa el scroll lateral a la rueda (Hasta abajo de la pantalla).</p>
            <p>¿Qué tanto sabes de mi?</p>
            <p>Calzo del ...</p>
            <p>Mi año nacimiento</p>
            <p>Año que Bluchino fue adoptado</p>
            <p>Modelo de mi Iphone</p>
            <p>Año que viajó Marty al futuro</p>

            <div class="chalkboard"></div>
            <div class="hint"></div>
         </div>
      </div>
   </main>

   <!-- PANTALLA FINAL -->
   <div class="celebration" id="celebration">
      <div class="secret-circle"></div>

      <span class="rune" style="top: 10%; left: 20%;">ᚠ</span>
      <span class="rune" style="top: 70%; left: 75%;">ᚱ</span>
      <span class="rune" style="top: 30%; left: 60%;">ᛟ</span>
      <span class="rune" style="top: 55%; left: 30%;">ᛉ</span>

      <h1>Acceso concedido<br>La bóveda se abre...</h1>

      <button class="rainbow-button" id="continueBtn">¿Te atreves?</button>
   </div>

   <!-- JS -->
   <!-- <script src="safe.js"></script> -->
   <script>
      const innerDial = document.querySelector(".innerdial");

      // Crear las marcas
      for (let i = 0; i < 16; i++) {
         const mark = document.createElement("div");
         mark.classList.add("mark");
         mark.style.transform = `rotate(${i * 22.5}deg) translateX(100px)`;
         innerDial.appendChild(mark);
      }

      innerDial.innerHTML += '<div class="center"><div class="start"></div></div>';

      const combination = [7, 84, 20, 11, 15];
      const pageHeight = window.innerHeight;

      let pos = 0, pSafePost = 0, cracked = false, win = false, timer;

      const root = document.documentElement;
      const posInput = document.getElementById("posInput");
      const chalkboard = document.querySelector(".chalkboard");
      const boxFlash = document.querySelector(".box-flash");
      const celebration = document.getElementById("celebration");

      function handleValue(safePos) {
         if (timer) clearTimeout(timer);

         timer = setTimeout(() => {
            boxFlash.classList.remove("click", "near", "off");
            posInput.classList.remove("correct");

            if (safePos && combination[pos] === safePos) {
               void boxFlash.offsetWidth;
               boxFlash.classList.add("click");
               posInput.classList.add("correct");
               chalkboard.innerText += safePos + "\n";

               if (++pos === combination.length) cracked = true;

            } else if (safePos && Math.abs(combination[pos] - safePos) < 3) {
               void boxFlash.offsetWidth;
               boxFlash.classList.add("near");
            } else {
               void boxFlash.offsetWidth;
               boxFlash.classList.add("off");
            }

            pSafePost = safePos;
         }, 100);

         if (cracked && !win) {
            win = true;
            setTimeout(() => {
               document.body.style.zoom = "1";
               celebration.style.display = "flex";
            }, 300);
         }
      }

      window.addEventListener("scroll", () => {
         root.style.setProperty("--scroll", window.scrollY);

         const safePos = Math.floor(window.scrollY / (10000 - pageHeight) * 100);
         posInput.value = safePos;

         handleValue(safePos);
      });

      posInput.addEventListener("input", () => {
         const safePos = parseInt(posInput.value);
         if (!isNaN(safePos)) handleValue(safePos);
      });

      // Botón continuar
      document.getElementById("continueBtn").addEventListener("click", () => {
         window.location.href = "papeles.html";
      });

   </script>
</body>

</html>