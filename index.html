<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <title>Â¿Sabes de mi?</title>

   <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

   <link rel="icon" href="safe.ico" type="image/x-icon">

   <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;400;500;600;700&display=swap"
      rel="stylesheet">

   <script src="https://public.codepenassets.com/js/prefixfree-1.0.7.min.js"></script>

   <style>
      :root { --scroll: 0; }

      body {
         margin: 0;
         display: flex;
         flex-direction: column;
         overflow-x: hidden;
         background-color: #444;
      }

      main { height: 100vh; }
      .r { height: 10000px; }

      .safe {
         position: fixed;
         top: 0;
         bottom: 0;
         width: 100vw;
         height: 100vh;
         display: flex;
         flex-direction: column;
         align-items: center;
         justify-content: center;
         background-color: #444;
         z-index: 2;
         transform: scale(1);
         transform-origin: center center;
      }

      .safe h1,
      .safe p {
         font-family: "Rajdhani", sans-serif;
         color: white;
      }

      .safe p {
         font-size: 0.9em;
         line-height: 1.5em;
         max-width: 250px;
         text-align: justify;
      }

      .box {
         width: 250px;
         height: 250px;
         display: flex;
         align-items: center;
         justify-content: center;
         transform: rotate(calc(var(--scroll) * 0.08deg));
         transform-origin: center;
      }

      /* ðŸ”¹ ESPACIADOR ESTABLE */
      .dial-spacer {
         height: clamp(32px, 5vh, 56px);
         flex-shrink: 0;
      }

      .innerdial {
         position: absolute;
         top: 0;
         left: 0;
         width: 250px;
         height: 250px;
         z-index: 2;
         background-color: silver;
         border: 1px solid black;
         border-radius: 50%;
      }

      .mark {
         position: absolute;
         top: 122px;
         left: 115px;
         width: 20px;
         height: 6px;
         background-color: grey;
         border: 1px solid black;
         transform-origin: 10px 3px;
      }

      .center {
         position: absolute;
         top: 50px;
         left: 50px;
         width: 150px;
         height: 150px;
         border-radius: 50%;
         background-color: grey;
         border: 1px solid black;
      }

      .start {
         position: absolute;
         top: 70px;
         left: 65px;
         width: 20px;
         height: 10px;
         background-color: white;
         transform: rotate(-90deg) translateX(60px);
      }

      .position {
         position: relative;
         margin-top: 5px;
         text-align: center;
         padding: 5px;
         min-width: 50px;
         border: 1px solid black;
         background-color: #fff;
         font-family: "Rajdhani", sans-serif;
         color: #444;
         border-radius: 5px;
         transition: 0.3s;
         font-size: 16px !important;
      }

      .correct {
         background-color: #c6ffbf;
         color: #145214 !important;
         border-color: #2b8a3e;
         font-weight: bold;
      }

      .box-flash {
         position: absolute;
         top: 0;
         left: 0;
         width: 250px;
         height: 250px;
         background-color: silver;
         border-radius: 50%;
         opacity: 0.9;
         z-index: -1;
      }

      .click { animation: click 0.2s 1; }
      .near { animation: near 0.2s 1; }
      .off { animation: off 0.2s 1; }

      @keyframes click {
         0% { background-color: pink; transform: scale(1); opacity: 1; }
         100% { background-color: pink; transform: scale(1.5); opacity: 0; }
      }

      @keyframes near {
         0% { background-color: lightcoral; transform: scale(1); opacity: 0.6; }
         100% { background-color: lightcoral; transform: scale(1.3); opacity: 0; }
      }

      @keyframes off {
         0% { opacity: 0.3; }
         100% { opacity: 0; }
      }

      .chalkboard {
         position: absolute;
         left: 15vw;
         top: 50vh;
         padding: 20px;
         font-size: 4em;
         font-family: "Rajdhani", sans-serif;
         transform: rotate(15deg);
         color: #fff;
         white-space: pre;
         line-height: 1em;
      }

      .hint {
         position: absolute;
         right: 20px;
         bottom: 20px;
         padding: 20px;
         font-family: "Rajdhani", sans-serif;
         transform: rotate(-15deg);
         white-space: pre;
         line-height: 1em;
         color: #393939;
      }

      body.dial .safe { position: fixed; }
      body.handle main { overflow: hidden; }
      body.handle .safe { position: initial; }

      /* RESPONSIVE SCALE ORIGINAL */
      @media (max-width: 1024px) { .safe { transform: scale(1.15); } }
      @media (max-width: 820px) { .safe { transform: scale(1); } }
      @media (max-width: 600px) { .safe { transform: scale(0.9); } }
      @media (max-width: 430px) { .safe { transform: scale(1); } }
      @media (max-width: 375px) { .safe { transform: scale(0.75); } }
   </style>
</head>

<body class="dial">
   <main>
      <div class="r">
         <div class="safe">

            <h1>Resuelve el cÃ³digo</h1>

            <div class="box">
               <div class="innerdial"></div>
               <div class="box-flash"></div>
            </div>

            <!-- âœ… ÃšNICO ELEMENTO NUEVO -->
            <div class="dial-spacer"></div>

            <input class="position" id="posInput" type="number" value="0">

            <p>Gira para encontrar la combinaciÃ³n. Usa el scroll lateral a la rueda (Hasta abajo de la pantalla).</p>
            <p>Â¿QuÃ© tanto sabes de mi?</p>
            <p>Calzo del ...</p>
            <p>Mi aÃ±o nacimiento</p>
            <p>AÃ±o que Bluchino fue adoptado</p>
            <p>Modelo de mi Iphone</p>
            <p>Â¿CuÃ¡ntas Champions League tiene Real Madrid?</p>

            <div class="chalkboard"></div>
            <div class="hint"></div>

         </div>
      </div>
   </main>

   <div class="celebration" id="celebration">
      <div class="secret-circle"></div>
      <span class="rune" style="top: 10%; left: 20%;">áš </span>
      <span class="rune" style="top: 70%; left: 75%;">áš±</span>
      <span class="rune" style="top: 30%; left: 60%;">á›Ÿ</span>
      <span class="rune" style="top: 55%; left: 30%;">á›‰</span>
      <h1>Acceso concedido<br>La bÃ³veda se abre...</h1>
      <button class="rainbow-button" id="continueBtn">Â¿Te atreves?</button>
   </div>

   <!-- ðŸ”’ JS ORIGINAL INTACTO -->
   <script>
      const innerDial = document.querySelector(".innerdial");

      for (let i = 0; i < 16; i++) {
         const mark = document.createElement("div");
         mark.classList.add("mark");
         mark.style.transform = `rotate(${i * 22.5}deg) translateX(100px)`;
         innerDial.appendChild(mark);
      }

      innerDial.innerHTML += '<div class="center"><div class="start"></div></div>';

      const combination = [7, 84, 20, 11, 15];
      const pageHeight = window.innerHeight;

      let pos = 0, pSafePost = 0, cracked = false, win = false, timer;

      const root = document.documentElement;
      const posInput = document.getElementById("posInput");
      const chalkboard = document.querySelector(".chalkboard");
      const boxFlash = document.querySelector(".box-flash");
      const celebration = document.getElementById("celebration");

      function handleValue(safePos) {
         if (timer) clearTimeout(timer);

         timer = setTimeout(() => {
            boxFlash.classList.remove("click", "near", "off");
            posInput.classList.remove("correct");

            if (safePos && combination[pos] === safePos) {
               void boxFlash.offsetWidth;
               boxFlash.classList.add("click");
               posInput.classList.add("correct");
               chalkboard.innerText += safePos + "\n";

               if (++pos === combination.length) cracked = true;

            } else if (safePos && Math.abs(combination[pos] - safePos) < 3) {
               void boxFlash.offsetWidth;
               boxFlash.classList.add("near");
            } else {
               void boxFlash.offsetWidth;
               boxFlash.classList.add("off");
            }

            pSafePost = safePos;
         }, 100);

         if (cracked && !win) {
            win = true;
            setTimeout(() => {
               celebration.style.display = "flex";
            }, 300);
         }
      }

      window.addEventListener("scroll", () => {
         root.style.setProperty("--scroll", window.scrollY);
         const safePos = Math.floor(window.scrollY / (10000 - pageHeight) * 100);
         posInput.value = safePos;
         handleValue(safePos);
      });

      posInput.addEventListener("input", () => {
         const safePos = parseInt(posInput.value);
         if (!isNaN(safePos)) handleValue(safePos);
      });

      document.getElementById("continueBtn").addEventListener("click", () => {
         window.location.href = "papeles.html";
      });
   </script>
</body>
</html>
